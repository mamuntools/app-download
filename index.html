<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Premium Download</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --bg: #0b0e14; --card: #161d29; --primary: #00d2ff; --accent: #ff0055; --text: #94a3b8; --gold: #f1c40f; --success: #2ecc71; }
        body { background: var(--bg); color: white; font-family: 'Inter', sans-serif; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }

        /* গাইডলাইন বক্স */
        .guideline-box { border: 2px solid var(--gold); border-radius: 15px; padding: 20px; width: 100%; max-width: 400px; margin-bottom: 30px; background: rgba(0,0,0,0.3); }
        .guideline-header { color: var(--gold); font-weight: bold; font-size: 18px; display: flex; align-items: center; gap: 10px; margin-bottom: 15px; border-bottom: 1px solid rgba(241,196,15,0.2); padding-bottom: 10px; }
        .guide-item { display: flex; align-items: center; gap: 12px; font-size: 13px; margin-bottom: 12px; line-height: 1.5; }
        .guide-item i { color: var(--gold); font-size: 14px; width: 15px; text-align: center; }
        .highlight { color: #fff; font-weight: bold; margin: 0 4px; }

        /* অ্যাপ কার্ড ডিজাইন */
        .app-card { background: var(--card); border-radius: 25px; padding: 30px; width: 100%; max-width: 380px; text-align: center; border: 1px solid #232d3d; box-shadow: 0 20px 40px rgba(0,0,0,0.5); position: relative; }
        .premium-badge { background: var(--accent); color: white; padding: 5px 15px; border-radius: 20px; font-size: 10px; font-weight: bold; display: inline-block; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px; }
        .app-icon { width: 110px; height: 110px; border-radius: 25px; margin: 0 auto 15px; display: block; object-fit: cover; border: 2px solid rgba(0, 210, 255, 0.1); }
        .app-name { font-size: 24px; font-weight: bold; margin-bottom: 8px; }
        
        /* মেটা ইনফো এবং আইকন */
        .meta-container { display: flex; justify-content: center; align-items: center; gap: 15px; margin-bottom: 25px; font-size: 13px; color: var(--text); }
        .meta-item { display: flex; align-items: center; gap: 5px; }
        .meta-item i { color: var(--primary); font-size: 14px; }

        /* বাটন স্টাইল */
        .btn { width: 100%; padding: 16px; border-radius: 12px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; border: none; font-size: 16px; transition: 0.3s; margin-bottom: 12px; }
        .btn-watch { background: var(--primary); color: #000; }
        .btn-download { background: #1e293b; color: #555; cursor: not-allowed; }
        .btn-unlocked { background: var(--success) !important; color: white !important; box-shadow: 0 0 20px rgba(46, 204, 113, 0.3); }

        /* ফুটারে নিরাপত্তা আইকন */
        .footer-icons { display: flex; justify-content: center; gap: 15px; margin-top: 20px; font-size: 11px; color: #556070; font-weight: bold; }
        .footer-icons span { display: flex; align-items: center; gap: 5px; text-transform: uppercase; }

        /* টাইমার পপআপ (অ্যাডস্টারার ব্যানারের জন্য উপযুক্ত) */
        #timerPopup { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; }
        .popup-box { background: white; width: 300px; height: 250px; border-radius: 15px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 20px; color: #333; font-weight: bold; position: relative; }
        .wait-label { background: #222; color: white; padding: 12px 25px; border-radius: 30px; border: 1px solid #444; font-size: 14px; }
    </style>
</head>
<body>

    <div class="guideline-box">
        <div class="guideline-header"><i class="fas fa-shield-halved"></i> ডাউনলোড গাইডলাইন</div>
        <div class="guide-item">
            <i class="fas fa-chevron-right"></i> 
            <span>ডাউনলোড বাটন আনলক করতে মোট <span class="highlight" id="gAds">...</span> টি অ্যাড দেখুন।</span>
        </div>
        <div class="guide-item">
            <i class="fas fa-chevron-right"></i> 
            <span>(Watch Ad) বাটনে ক্লিক করার পর <span class="highlight" id="gSec">...</span> সেকেন্ড অপেক্ষা করুন।</span>
        </div>
        <div class="guide-item">
            <i class="fas fa-chevron-right"></i> 
            <span>সফলভাবে সব অ্যাড দেখা শেষ হলে <span id="gColor" style="color:var(--success); font-weight:bold;">সবুজ</span> রঙের ডাউনলোড বাটনটি আসবে।</span>
        </div>
    </div>

    <div class="app-card">
        <div class="premium-badge">Premium Unlocked</div>
        <img id="appIcon" src="" class="app-icon" alt="App">
        <div class="app-name" id="appName">Loading...</div>
        
        <div class="meta-container">
            <div class="meta-item"><i class="fas fa-star"></i> 4.9</div>
            <div class="meta-item"><i class="fas fa-file-arrow-down"></i> <span id="appSize">...</span></div>
            <div class="meta-item"><i class="fas fa-circle-check"></i> Verified</div>
        </div>

        <button id="watchBtn" class="btn btn-watch" onclick="runAd()">
            <i class="fas fa-circle-play"></i> Watch Ad ( <span id="cur">0</span> / <span id="total">0</span> )
        </button>

        <button id="dlBtn" class="btn btn-download" disabled>
            <i class="fas fa-lock"></i> Download Now (Free)
        </button>

        <div class="footer-icons">
            <span><i class="fas fa-shield-virus"></i> No Virus</span>
            <span><i class="fas fa-bolt"></i> Fast Link</span>
            <span><i class="fas fa-cloud"></i> Cloud Host</span>
        </div>
    </div>

    <div id="timerPopup">
        <div class="popup-box">
            <p style="font-size: 12px; color: #999;">ADVERTISEMENT AREA</p>
        </div>
        <div class="wait-label" id="timerLabel">Please wait 10 seconds...</div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCPbYi4l4gXESVFDEf93n1nvKshUOxwwf0",
            authDomain: "my-admin-panel-a70cc.firebaseapp.com",
            databaseURL: "https://my-admin-panel-a70cc-default-rtdb.firebaseio.com",
            projectId: "my-admin-panel-a70cc",
            appId: "1:992979831424:web:ba765f5bb23db644693465"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let maxAds = 0, timerVal = 10, currentStep = 0;
        let adData = {}; // সম্পূর্ণ ডাটা স্টোর করার জন্য

        // প্যানেল থেকে ডাটা সিঙ্ক (Updated for 5 links)
        db.ref('appSettings').on('value', (snap) => {
            adData = snap.val();
            if(adData) {
                maxAds = parseInt(adData.totalAds);
                timerVal = parseInt(adData.adTimer);

                document.getElementById('appName').innerText = adData.appName;
                document.getElementById('appIcon').src = adData.appIcon;
                document.getElementById('appSize').innerText = adData.appSize;
                document.getElementById('total').innerText = maxAds;
                
                document.getElementById('gAds').innerText = maxAds;
                document.getElementById('gSec').innerText = timerVal;
                document.getElementById('pageTitle').innerText = adData.appName + " - Premium Download";
            }
        });

        function runAd() {
            if(currentStep < maxAds) {
                // প্যানেলের ৫টি লিঙ্ক থেকে বর্তমান ধাপের লিঙ্কটি নেওয়া
                let links = [adData.adL1, adData.adL2, adData.adL3, adData.adL4, adData.adL5];
                let currentAdUrl = links[currentStep] || adData.adL1; 

                // ডাইরেক্ট লিঙ্ক ওপেন করা
                window.open(currentAdUrl, '_blank');

                const popup = document.getElementById('timerPopup');
                const label = document.getElementById('timerLabel');
                popup.style.display = 'flex';
                
                let counter = timerVal;
                const interval = setInterval(() => {
                    label.innerText = `Please wait ${counter} seconds...`;
                    counter--;
                    
                    if(counter < 0) {
                        clearInterval(interval);
                        popup.style.display = 'none';
                        currentStep++;
                        refreshUI();
                    }
                }, 1000);
            }
        }

        function refreshUI() {
            document.getElementById('cur').innerText = currentStep;
            if(currentStep >= maxAds) {
                const wBtn = document.getElementById('watchBtn');
                const dBtn = document.getElementById('dlBtn');
                
                wBtn.style.display = 'none';
                dBtn.disabled = false;
                dBtn.classList.remove('btn-download');
                dBtn.classList.add('btn-unlocked');
                dBtn.innerHTML = `<i class="fas fa-download"></i> Download Now (Free)`;
                dBtn.onclick = () => window.location.href = adData.downloadLink;
            }
        }
    </script>
</body>
</html>
